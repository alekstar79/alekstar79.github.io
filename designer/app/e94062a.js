(window.webpackJsonp=window.webpackJsonp||[]).push([[217],{1136:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(28),r=n(252);var o=n(178);function s(t){var e="function"==typeof Map?new Map:void 0;return s=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,s)}function s(){return Object(o.a)(t,arguments,Object(i.a)(this).constructor)}return s.prototype=Object.create(t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),Object(r.a)(s,t)},s(t)}},1148:function(t,e,n){var i=n(6),r=n(44),o=n(179);i({target:"Object",stat:!0},{fromEntries:function(t){var e={};return r(t,(function(t,n){o(e,t,n)}),{AS_ENTRIES:!0}),e}})},1401:function(t,e,n){},1469:function(t,e,n){"use strict";n.d(e,"d",(function(){return k})),n.d(e,"c",(function(){return j})),n.d(e,"a",(function(){return y.a})),n.d(e,"b",(function(){return E}));var i,r=n(1),o=n(0),s=n.n(o),c=(n(256),n(3),n(9),n(19),n(43),n(57),n(84),n(182),n(87),n(24),n(158)),a=n(68),u={keyCode:16,diff:null},l=Math.hypot,h=Math.floor,d=Math.round,f=function(t,e){return new i.Point(0,0).add(t).subtract(e)},v=function(t){return new i.Point(t.width/2,t.height/2)},p=function(t){return d(100*t)/100};function m(t,e){return{height:t.height*e,width:t.width*e,scale:e}}function g(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=i.util.findScaleToFit(t,e);return m(t,p(r-n))}function b(t,e){return f(v(t),v(e))}Array.prototype.bypass=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"event";(t.length?this.filter((function(e){return t.includes(e[n])})):this).forEach((function(t){return e(t)}))};var w,k={data:function(){return{drawerOptions:this.$store.state.canvas.drawerOptions,emap:[{event:"selection:cleared",handler:this.cleared},{event:"object:selected",handler:this.selected},{event:"mouse:over",handler:this.mouseOver},{event:"mouse:down",handler:this.mouseDown},{event:"mouse:move",handler:this.mouseMove},{event:"mouse:out",handler:this.mouseOut},{event:"mouse:up",handler:this.mouseUp},{event:"restore:events",handler:this.restoreEvents},{event:"stack:changed",handler:this.restoreActiveObjects},{event:"leave:events",handler:this.leaveEvents},{event:"image:remove-bg",handler:this.popupRemBg},{event:"widget:settings",handler:this.popupWidget},{event:"curved:settings",handler:this.popupCurved},{event:"drawingtool:history",handler:this.stateTools},{event:"frame:composite",handler:this.composite},{event:"shape:settings",handler:this.popupShape},{event:"ctext:settings",handler:this.popupText},{event:"merge:settings",handler:this.popupMerge},{event:"qrcode:settings",handler:this.popupQRCode},{event:"path:colorize",handler:this.colorize},{event:"canvas:distort",handler:this.distort},{event:"canvas:snack",handler:this.snack},{event:"canvas:flash",handler:this.flash}],onCanvas:!1,freedraw:!1,isDown:!1,corner:!1,cursorMode:1,object:null,global:null,active:[],offmap:[]}},computed:{client:{set:function(t){this.$store.commit("canvas/set",{client:t})},get:function(){return this.$store.state.canvas.client}},origin:{set:function(t){this.$store.commit("canvas/set",{origin:t})},get:function(){return this.$store.state.canvas.origin}},scaled:{set:function(t){this.$store.commit("canvas/set",{scaled:t})},get:function(){return this.$store.state.canvas.scaled}},track:{set:function(t){this.$store.commit("canvas/set",{track:t})},get:function(){return this.$store.state.canvas.track}},diagonal:{set:function(t){this.$store.commit("canvas/set",{diagonal:t})},get:function(){return this.$store.state.canvas.diagonal}},shiftKey:{set:function(t){this.$store.commit("canvas/set",{shiftKey:t})},get:function(){return this.$store.state.canvas.shiftKey}},point:{set:function(t){this.$store.commit("canvas/set",{point:t})},get:function(){return this.$store.state.canvas.point}},isDraw:function(){return this.freedraw&&0===this.cursorMode},isFree:function(){return!(this.isDown||this.active.length)}},methods:{set:function(t){this.$store.commit("canvas/set",t)},setClient:function(){var t=this;return Object(r.a)(s.a.mark((function e(){var n,i,r,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$nextTick();case 2:n=window.innerHeight,i=window.innerWidth,.95,.91,o=(r={}).height=h(.91*n),c=r.width=h(.95*i),r.left=h((i-c)/2),r.top=h((n-o)/2),t.diagonal=l(c,o),t.client=r;case 7:case"end":return e.stop()}}),e)})))()},correction:function(t){t.x+=20,t.y+=15},fitToWindow:function(t){var e=this;return Object(r.a)(s.a.mark((function n(){var i,r;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.$nextTick();case 2:try{i=g(t,e.client,.1),r=b(e.client,i),e.correction(r),e.set({scaled:i,track:r})}catch(o){}case 3:case"end":return n.stop()}}),n)})))()},fitToOrigin:function(t){var e=this;return Object(r.a)(s.a.mark((function n(){var i,r;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.$nextTick();case 2:try{i=b(e.client,t),r=m(t,1),e.correction(i),e.set({scaled:r,track:i})}catch(o){}case 3:case"end":return n.stop()}}),n)})))()},zoom:function(t){var e=m(this.origin,this.scaled.scale+t);if(t>0&&this.increase(e)||t<0&&this.decrease(e)){var n=b(this.client,e);this.correction(n),this.track=this.track.lerp(n,.1),this.scaled=e}},setOrigin:function(t,e){var n=this,i={width:t,height:e};return this.setClient().then((function(){return n.fitToWindow(i)})).then((function(){return n.set({origin:i})}))},setScaled:function(t,e,n){var i=this,r=function(t){var e=t.height,n=t.width,i=t.scale;return{height:e/i,width:n/i}}({width:t,height:e,scale:n});return this.setClient().then((function(){return i.fitToWindow(r)})).then((function(){return i.set({origin:r})}))},createContext:function(t){var e=this;return Object(r.a)(s.a.mark((function n(){var i,r,o;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.width,r=t.height,o=t.scale,n.next=3,"number"==typeof o?e.setScaled(i,r,o):e.setOrigin(i,r);case 3:case"end":return n.stop()}}),n)})))()},keyDownTrack:function(t){var e=t.which,n=t.code;(e||n)&&(e===u.keyCode||n.startsWith("Shift"))&&(this.shiftKey=!0,this.isDraw||(this.canvas.defaultCursor="move",this.canvas.selection=!1))},keyUpTrack:function(t){!t.repeat&&this.canvas&&(this.canvas.selection=!this.freedraw,this.canvas.defaultCursor=this.freedraw?"crosshair":"default",this.shiftKey=!1)},preInsert:function(){switch(this.canvas.hoverCursor=this.canvas.defaultCursor="crosshair",this.leaveEvents(),this.drawer.type){case"polyline":case"triangle":case"ellipse":case"rect":case"line":this.drawerOptions=this.$store.state.canvas.drawerOptions;break;case"c-text":this.drawerOptions=this.$store.state.canvas.textOptions}},postInsert:function(t){if(t||(t=this.object),"c-text"===t.type)t.on("editing:entered",this.bindings.untrack),t.on("editing:exited",this.bindings.track)},mouseDown:function(t){var e=this;return Object(r.a)(s.a.mark((function n(){var r,o,c;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=e.canvas.getPointer(t.e),o=r.x,c=r.y,e.isDown=!e.cursorMode,n.t0=!0,n.next=n.t0===(e.isDraw&&e.isDown)?5:n.t0===e.shiftKey?13:15;break;case 5:return e.preInsert(),n.next=8,e.drawer.make({x:o,y:c},e.drawerOptions);case 8:return e.object=n.sent,e.canvas.add(e.object),e.canvas.renderAll(),e.postInsert(),n.abrupt("break",15);case 13:u.diff=e.track.subtract(i.util.getPointer(t.e)),t.target&&(e.corner=e.findCorner(t),e.corner||(t.target.lockMovementX=!0,t.target.lockMovementY=!0));case 15:case"end":return n.stop()}}),n)})))()},mouseMove:function(t){var e=this;return Object(r.a)(s.a.mark((function n(){var r,o,c,a;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=t.e,n.prev=1,o=e.point=e.canvas.getPointer(r),c=o.x,a=o.y,n.t0=!0,n.next=n.t0===(e.isDraw&&e.isDown)?6:n.t0===(!e.corner&&!!u.diff)?11:13;break;case 6:return e.canvas.hoverCursor=e.canvas.defaultCursor="crosshair",n.next=9,e.drawer.resize(e.object,{x:c,y:a},e.shiftKey);case 9:return e.canvas.renderAll(),n.abrupt("break",13);case 11:return e.set({track:(s=i.util.getPointer(r),l=u.diff,new i.Point(0,0).add(s).add(l))}),n.abrupt("break",13);case 13:n.next=17;break;case 15:n.prev=15,n.t1=n.catch(1);case 17:case"end":return n.stop()}var s,l}),n,null,[[1,15]])})))()},mouseUp:function(t){var e=this;return Object(r.a)(s.a.mark((function n(){return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.isDown=e.corner=!1,u.diff=null,t.target&&(t.target.lockMovementX=!1,t.target.lockMovementY=!1),e.leaveEventsSet&&e.restoreEvents(),n.t0=e.cursorMode,n.next=0===n.t0?7:1===n.t0?11:12;break;case 7:if(!e.isDraw||e.clear()){n.next=10;break}return n.next=10,e.stack("update");case 10:case 11:return n.abrupt("break",12);case 12:e.selectedObjects(),e.object=null;case 14:case"end":return n.stop()}}),n)})))()},mouseOver:function(t){var e=t.target;this.cursorMode=Number(!!e&&!this.isDown),e&&(e.onHover=!0,(this.isFree||"curved-controls"===e.type)&&(this.canvas.hoverCursor=this.canvas.defaultCursor="move",this.setActive(e)))},mouseOut:function(t){(t.target||{}).onHover=!1,this.canvas.defaultCursor="default",this.active.length||this.discardActive()},selected:function(){this.isDraw||(this.cursorMode=1)},cleared:function(){this.cursorMode=Number(!this.freedraw)},increase:function(t){var e=t.width,n=t.height;return!(t.scale>1.5)||l(n,e)<2*this.diagonal},decrease:function(t){var e=t.width,n=t.height;return!(t.scale<.5)||l(n,e)>.25*this.diagonal},wheelTrack:function(t){if(this.origin&&this.scaled&&/upper-canvas|editzone|ruler|track/.test(t.target.className)){var e=t.deltaY||t.wheelDelta,n=this.scaled.scale+(e>0?.01:-.01),r=m(this.origin,n);(e>0&&this.increase(r)||e<0&&this.decrease(r))&&(this.track=this.track.lerp(f(i.util.getPointer(t),v(r)),.05),this.scaled=r),t.preventDefault()}},findCorner:function(t){var e=t.target,n=void 0!==e&&e,i=t.e;return n&&n._findTargetCorner(this.canvas.getPointer(i,!0))},moveTrack:function(t){try{this.global=i.util.getPointer(t),this.onCanvas=(e=t.target,n=e.tagName,r=e.classList,"CANVAS"===n&&r.contains("upper-canvas"))}catch(t){}var e,n,r},bindMoveTracker:function(){var t=!!this.$BROWSER.PASSIVE_SUPPORTED&&{passive:!0};document.addEventListener("mousemove",this.moveTrack,t)},unbindMoveTracker:function(){var t=!!this.$BROWSER.PASSIVE_SUPPORTED&&{passive:!0};document.removeEventListener("mousemove",this.moveTrack,t)},initializeShortCutEvents:function(){var t=this.copier.copy.bind(this.copier),e=this.copier.cut.bind(this.copier);this.offmap=this.bindings.bind([{keys:"shift+f",handler:this.autoAdjust},{keys:"Delete",handler:this.deleteSelected},{keys:"ctrl+a",handler:this.selectAll},{keys:"ctrl+z",handler:this.undo},{keys:"ctrl+y",handler:this.redo},{keys:"ctrl+c",handler:t},{keys:"ctrl+x",handler:e}]),this.bindings.track()},distort:Object(c.debounce)((function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.reload,i=void 0!==n&&n,r=e.resolve;if("function"!=typeof r&&(r=function(){}),!this.origin||!this.scaled||this.leaveEventsSet)return r();var o=this.origin,s=this.scaled.scale,c=function(t){return Object(a.running)(t)},u=i?.03:.01,l=s+u,h=s-u,d=s,f=function(e){return function(){return(t.scaled=m(o,t.scaled.scale+u)).scale>=e}},v=function(e){return function(){return(t.scaled=m(o,t.scaled.scale-u)).scale<=e}},p=function(){t.canvas.trigger("canvas:shaken")},g=function(){t.canvas.requestRenderAll()},b=this.canvasFinalize.bind(this);Promise.resolve().then((function(){return c(f(l))})).then((function(){return c(v(i?h:d))})).then((function(){return i?c(f(d)):Promise.resolve()})).then(b).then(p).then(g).then(r)}),7),keyEventsOff:function(){var t=!this.$BROWSER.PASSIVE_SUPPORTED||{passive:!1};document.removeEventListener("keydown",this.keyDownTrack,t),document.removeEventListener("keyup",this.keyUpTrack,t),document.removeEventListener("wheel",this.wheelTrack,t)},keyEventsOn:function(){var t=!this.$BROWSER.PASSIVE_SUPPORTED||{passive:!1};document.addEventListener("keydown",this.keyDownTrack,t),document.addEventListener("keyup",this.keyUpTrack,t),document.addEventListener("wheel",this.wheelTrack,t)},switcher:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.emap.bypass(n,(function(n){var i=n.event,r=n.handler;e.canvas[t](i,r)}))},trackerEventsOff:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&this.keyEventsOff(),this.canvas&&this.switcher("off",t)},trackerEventsOn:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&this.keyEventsOn(),this.canvas&&this.switcher("on",t)},passFabricInstanceToTrack:function(t){i=t}}},O=(n(51),n(1177)),j=Object(O.b)((function(t){t.intro.options.showBullets=!1,t.intro.autoRefresh=!1;var e=0;return[new O.a({step:++e,element:".image-editor",title:"Welcome!",intro:"intro.designer_01",action:function(){return new Promise((function(e){t.intro.hold&&t.intro.hold.classList.remove("down"),setTimeout(e,250)}))}}),new O.a({step:++e,element:".image-editor__topbar",intro:"intro.designer_02",action:function(e){return new Promise((function(n){t.presentation=!0,t.$refs.menu.hideBlock(0),t.activateItem(e,"down"),setTimeout(n,250)}))}}),new O.a({step:++e,element:null,intro:"intro.designer_03",action:function(e){var n=this.step-1;return t.$refs.menu.viewBlock(0).then((function(){return new Promise((function(i){e=Object(O.c)(".top-menu.file"),t.intro.instance._introItems[n].element=e,t.intro.instance._introItems[n].position="left",t.intro.hold=Object(O.c)(".image-editor__topbar"),t.intro.hold.classList.add("down"),setTimeout(i,250)}))}))}}),new O.a({step:++e,element:null,intro:"intro.designer_04",action:function(e){var n=this.step-1;return t.$refs.menu.viewBlock(1).then((function(){return new Promise((function(i){e=Object(O.c)(".top-menu.edit"),t.intro.instance._introItems[n].element=e,t.intro.instance._introItems[n].position="left",t.intro.hold=Object(O.c)(".image-editor__topbar"),t.intro.hold.classList.add("down"),setTimeout(i,250)}))}))}}),new O.a({step:++e,element:null,intro:"intro.designer_05",action:function(e){var n=this.step-1;return t.$refs.menu.viewBlock(2).then((function(){return new Promise((function(i){e=Object(O.c)(".top-menu.image"),t.intro.instance._introItems[n].element=e,t.intro.instance._introItems[n].position="left",t.intro.hold=Object(O.c)(".image-editor__topbar"),t.intro.hold.classList.add("down"),setTimeout(i,250)}))}))}}),new O.a({step:++e,element:null,intro:"intro.designer_06",action:function(e){var n=this.step-1;return t.$refs.menu.viewBlock(3).then((function(){return new Promise((function(i){e=Object(O.c)(".top-menu.layer"),t.intro.instance._introItems[n].element=e,t.intro.instance._introItems[n].position="left",t.intro.hold=Object(O.c)(".image-editor__topbar"),t.intro.hold.classList.add("down"),setTimeout(i,250)}))}))}}),new O.a({step:++e,element:null,intro:"intro.designer_07",action:function(e){var n=this.step-1;return t.$refs.menu.viewBlock(4).then((function(){return new Promise((function(i){e=Object(O.c)(".top-menu.tools"),t.intro.instance._introItems[n].element=e,t.intro.instance._introItems[n].position="left",t.intro.hold=Object(O.c)(".image-editor__topbar"),t.intro.hold.classList.add("down"),setTimeout(i,250)}))}))}}),new O.a({step:++e,element:null,intro:"intro.designer_08",action:function(e){var n=this.step-1;return t.$refs.menu.viewBlock(5).then((function(){return new Promise((function(i){e=Object(O.c)(".top-menu.help"),t.intro.hold&&t.intro.hold.classList.remove("visible"),t.intro.instance._introItems[n].element=e,t.intro.instance._introItems[n].position="left",t.intro.hold=Object(O.c)(".image-editor__topbar"),t.intro.hold.classList.add("down"),setTimeout(i,250)}))}))}}),new O.a({step:++e,element:".image-list",intro:"intro.designer_09",position:"top",action:function(e){return new Promise((function(n){t.intro.hold&&t.intro.hold.classList.remove("down"),t.$refs.sticker.hideBlock(0),t.$refs.menu.hideBlock(5),t.activateItem(e,"visible"),setTimeout(n,250)}))}}),new O.a({step:++e,element:null,intro:"intro.designer_10",action:function(e){var n=this.step-1;return t.$refs.sticker.viewBlock(0).then((function(){return new Promise((function(i){e=Object(O.c)(".bottom-menu.wdg"),t.intro.instance._introItems[n].position="right",t.intro.instance._introItems[n].element=e,t.intro.hold=Object(O.c)(".image-list"),t.intro.hold.classList.add("visible"),setTimeout(i,250)}))}))}}),new O.a({step:++e,element:null,intro:"intro.designer_11",action:function(e){var n=this.step-1;return t.$refs.sticker.viewBlock(1).then((function(){return new Promise((function(i){e=Object(O.c)(".bottom-menu.png"),t.intro.instance._introItems[n].position="right",t.intro.instance._introItems[n].element=e,t.intro.hold=Object(O.c)(".image-list"),t.intro.hold.classList.add("visible"),setTimeout(i,250)}))}))}}),new O.a({step:++e,element:null,intro:"intro.designer_12",action:function(e){var n=this.step-1;return t.$refs.sticker.viewBlock(2).then((function(){return new Promise((function(i){e=Object(O.c)(".bottom-menu.svg"),t.intro.instance._introItems[n].position="left",t.intro.instance._introItems[n].element=e,t.intro.hold=Object(O.c)(".image-list"),t.intro.hold.classList.add("visible"),setTimeout(i,250)}))}))}}),new O.a({step:++e,element:null,intro:"intro.designer_13",action:function(e){var n=this.step-1;return t.$refs.sticker.viewBlock(3).then((function(){return new Promise((function(i){e=Object(O.c)(".bottom-menu.set"),t.intro.instance._introItems[n].position="left",t.intro.instance._introItems[n].element=e,t.intro.hold=Object(O.c)(".image-list"),t.intro.hold.classList.add("visible"),setTimeout(i,250)}))}))}}),new O.a({step:++e,element:null,intro:"intro.designer_14",action:function(e){var n=this.step-1;return t.$refs.sticker.viewBlock(4).then((function(){return new Promise((function(i){e=Object(O.c)(".bottom-menu.bgd"),t.intro.instance._introItems[n].position="left",t.intro.instance._introItems[n].element=e,t.intro.hold=Object(O.c)(".image-list"),t.intro.hold.classList.add("visible"),setTimeout(i,250)}))}))}}),new O.a({step:++e,element:".tool-wrapper.left",intro:"intro.designer_15",position:"right",correction:{height:"calc({0} + 2%)",top:"calc({0} - 1.5%)"},action:function(e){return new Promise((function(n){t.intro.hold&&t.intro.hold.classList.remove("visible"),t.$refs.sticker.hideBlock(4),t.activateItem(e,"visible"),setTimeout(n,250)}))}}),new O.a({step:++e,element:".tool-wrapper.right",intro:"intro.designer_16",position:"left",correction:{height:"calc({0} + 2%)",top:"calc({0} - 1.5%)"},action:function(e){return new Promise((function(n){t.activateItem(e,"visible"),setTimeout(n,250)}))}}),new O.a({step:++e,element:"#canvas-context-menu",intro:"intro.designer_17",action:function(e){var n=this;return new Promise((function(i){t.intro.instance._introItems[n.step-1].position="bottom",t.intro.target=e,t.$refs.context.show({clientY:.4*t.$screen.height,clientX:.55*t.$screen.width,presentation:!0}),setTimeout(i,250)}))},onchange:O.f.debounce((function(){t.intro.instance.refresh(!0)}),10)}),new O.a({step:++e,element:null,intro:"intro.designer_18",action:function(){var e=this;return t.setCanvas({width:480,height:360}).then((function(){return new Promise((function(n){var i=Object(O.c)(".rg-overlay");t.zoom(-.5),t.intro.instance._introItems[e.step-1].element=i,t.intro.target=i,setTimeout(n,250)}))}))}})]}),{cleanup:function(){var t=this;return new Promise((function(e){Object(O.e)((function(){return t.intro.target.classList.remove(t.intro.target.getAttribute("data-rem"))})),Object(O.e)((function(){return t.$refs.context.hide()})),Object(O.e)((function(){return t.discharge(4)})),e()}))},activateItem:function(t,e){"string"==typeof e&&(t.classList.add(e),t.setAttribute("data-rem",e)),this.intro.target=t}}),y=n(497),_=n(163),x=n(4),S=Math.max,$=Math.min,T=Math.abs;function P(){return C.apply(this,arguments)}function C(){return(C=Object(r.a)(s.a.mark((function t(){var e;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.Fabric.resolve();case 2:return e=t.sent,w||(w=e.util.createClass(e.Rect,x.cropzone)),t.abrupt("return",new w({fill:"rgba(255,255,255,.3)",hasRotatingPoint:!1,hasBorders:!1,lockScalingFlip:!0,lockRotation:!0,strokeWidth:0,left:-10,top:-10,width:1,height:1}));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var E={computed:{withShiftKey:function(){return this.$store.state.canvas.shiftKey}},data:function(){return{cropedObject:null,cropzone:null,startX:null,startY:null,ratio:null}},methods:{setCropControls:function(){this.cropzone.customiseControls({mtr:{action:null,cursor:null},mb:{action:null,cursor:null},mr:{action:null,cursor:null},mt:{action:null,cursor:null},bl:{action:null,cursor:null},br:{action:null,cursor:null},tr:{action:this.cropEnd.bind(this),cursor:"pointer"},tl:{action:this.cropCancel.bind(this),cursor:"pointer"}}),this.cropzone.customiseCornerIcons({settings:{borderColor:"#0094dd",cornerBackgroundColor:"#0094dd",cornerShape:"rect",cornerPadding:5,cornerSize:15},mtr:{icon:_.blank},mt:{icon:_.blank},mb:{icon:_.blank},mr:{icon:_.blank},bl:{icon:_.blank},br:{icon:_.blank},tl:{icon:_.close},tr:{icon:_.check}})},releaseCrop:function(){var t=this.cropedObject.setCoords();if(!this.cropzone||!this.cropzone.isValid()||!this.cropzone.intersectsWithObject(t))return Promise.reject();var e=t.getBoundingRect(!0),n=e.left,i=e.top,r=e.width,o=e.height,s=this.cropzone.getScaledHeight(),c=this.cropzone.getScaledWidth(),a=this.cropzone.get("left"),u=this.cropzone.get("top"),l=S(a-n,0),h=S(u-i,0),d=$(i>u?u+s-i:s,o-h),f=$(n>a?a+c-n:c,r-l),v=d/2,p=f/2;return new Promise((function(e){return e({src:t.toDataURL({left:l,top:h,width:f,height:d}),originX:"center",originY:"center",left:S(a,n)+p,top:S(u,i)+v,height:d,width:f})}))},calcRectDimensionFromPoint:function(t,e){var n=this.canvas.getZoom(),i=this.canvas.getHeight()/n,r=this.canvas.getWidth()/n,o=this.startX,s=this.startY,c=S(0,$(t,o)),a=S(0,$(e,s)),u=S(o,$(t,r))-c,l=S(s,$(e,i))-a;return this.withShiftKey?(u=l/this.ratio,o>=t&&(c=o-u),s>=e&&(a=s-l)):this.ratio=l/u,{left:c,top:a,width:u,height:l}},setZone:function(t){var e=t.left,n=t.top,i=t.width,r=t.height;this.cropzone.set({left:e,top:n,height:r,width:i}).setCoords(),this.canvas.calcOffset().renderAll()},setEvented:function(t){this.canvas.forEachObject((function(e){e.evented=t}))},checkObject:function(t){var e=null;switch(!0){case!t:e="select_croped_object";break;case"activeSelection"===t.type:case"image"!==t.type:e="select_single_object"}return e},cropInset:function(){var t=this;return Object(r.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.fixedCursor="crosshair",t.canvas.defaultCursor="crosshair",t.canvas.selection=!1,e.next=5,P();case 5:t.cropzone=e.sent,t.canvas.add(t.cropzone),t.setCropControls(),t.canvas.on({"object:scaling":t.onObjectScaling,"object:moving":t.onObjectMoving,"mouse:down":t.onMouseDown});case 9:case"end":return e.stop()}}),e)})))()},cropReset:function(){this.fixedCursor=null,this.canvas.defaultCursor="default",this.canvas.selection=!0,this.canvas.off({"object:scaling":this.onObjectScaling,"object:moving":this.onObjectMoving,"mouse:down":this.onMouseDown}),this.canvas.remove(this.cropzone),this.cropzone=null},cropStart:function(){var t=this;return Object(r.a)(s.a.mark((function e(){var n,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.cropzone){e.next=2;break}return e.abrupt("return",!1);case 2:if(i=t.canvas.getActiveObject(),!(n=t.checkObject(i))){e.next=6;break}return t.$bus.$emit("snack",{content:"graph.".concat(n),color:"warning"}),e.abrupt("return",!1);case 6:return t.unbindStateHandler(),t.setEvented(!1),e.next=10,t.cropInset();case 10:return t.cropedObject=i,e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e)})))()},cropEnd:function(){var t=this;this.releaseCrop().then((function(e){t.canvas.remove(t.cropedObject),t.cropReset(),t.bindStateHandler(),t.createImage(e,!1,(function(e){t.setActive(e),t.selectedObjects()}))})).catch((function(){t.cropReset(),t.bindStateHandler()})).finally((function(){t.setEvented(!0),t.$emit("crop:end")}))},cropCancel:function(){var t=this;return this.$nextTick().then((function(){t.cropReset(),t.bindStateHandler(),t.toActive(t.cropedObject),t.selectedObjects()})).finally((function(){t.setEvented(!0),t.$emit("crop:reset")}))},onObjectScaling:function(t){var e=t.target;if(e===this.cropzone){var n=this.canvas.getZoom(),i=this.canvas.getHeight()/n,r=this.canvas.getWidth()/n,o=e.left,s=e.top,c=e.left+e.getScaledWidth(),a=e.top+e.getScaledHeight();(o<0||c>r||s<0||a>i)&&(e.scaleX=this.lastScaleX||1,e.scaleY=this.lastScaleY||1,o<0&&(e.left=0),s<0&&(e.top=0)),e.getScaledWidth()<1&&e.scaleToWidth(1,!0),e.getScaledHeight()<1&&e.scaleToHeight(1,!0),this.lastScaleX=e.scaleX,this.lastScaleY=e.scaleY}},onObjectMoving:function(t){var e=t.target;if(e===this.cropzone){var n=this.canvas.getZoom(),i=this.canvas.getHeight(),r=this.canvas.getWidth(),o=e.getScaledHeight(),s=e.getScaledWidth(),c=e.left,a=e.top,u=i/n-o,l=r/n-s;e.left=S(0,$(c,l)),e.top=S(0,$(a,u))}},onMouseDown:function(t){var e=t.target,n=t.e;if(!n.shiftKey&&e!==this.cropzone){var i=this.canvas.getPointer(n),r=i.x,o=i.y;this.startX=r,this.startY=o,this.canvas.discardActiveObject(n),this.canvas.setActiveObject(this.cropzone).bringToFront(this.cropzone),this.canvas.on({"mouse:move":this.onMouseMove,"mouse:up":this.onMouseUp})}},onMouseMove:function(t){var e=t.e;if(null!==this.startX){var n=this.canvas.getPointer(e),i=n.x,r=n.y;T(i-this.startX)+T(r-this.startY)>10&&this.setZone(this.calcRectDimensionFromPoint(i,r))}},onMouseUp:function(){this.canvas.off({"mouse:move":this.onMouseMove,"mouse:up":this.onMouseUp}),this.startX=null,this.startY=null}}}},1504:function(t,e,n){"use strict";n(1401)},1678:function(t,e,n){"use strict";n.r(e);n(3),n(14),n(15),n(371),n(256);var i=n(1469),r={mixins:[i.d],components:{VueSlider:function(){return n.e(321).then(n.t.bind(null,1893,7))}},filters:{round:function(t){return(t+.5|0)+"%"}},computed:{color:function(){return this.$store.state.app.color},mobile:function(){return!!(this.$BROWSER||{}).IS_MOBILE},scaled:{set:function(t){this.$store.commit("canvas/set",{scaled:t})},get:function(){return this.$store.state.canvas.scaled}},scale:{set:function(t){this.zoom(t/100-this.scaled.scale>0?.01:-.01)},get:function(){var t=100*this.scaled.scale.toFixed(2),e=this.options,n=e.max,i=e.min;return t>=n?n:t<=i?i:t+.5|0}}},data:function(){var t=this.$store.state.canvas.origin,e=t.height,n=t.width,i=this.$store.state.canvas.diagonal,r=Math.hypot(n,e),o=100*i*2/r+.5|0,s=100*i*.25/r+.5|0;return{active:!1,options:{processStyle:{backgroundColor:"#5181b8"},useKeyboard:!0,clickable:!0,direction:"btt",duration:.3,dotSize:20,interval:(o-s)/100,min:s,max:o}}}},o=(n(1504),n(250)),s=Object(o.a)(r,(function(){var t=this,e=t._self._c;return e("client-only",[e("vue-slider",t._b({class:{mobile:t.mobile,active:t.active},attrs:{direction:"btt",height:"80vh",width:"8px"},on:{"drag-start":function(e){t.active=!0},"drag-end":function(e){t.active=!1}},scopedSlots:t._u([{key:"tooltip",fn:function(n){var i=n.value;return[e("div",{staticClass:"vue-slider-dot-tooltip vue-slider-dot-tooltip-left"},[e("div",{staticClass:"vue-slider-dot-tooltip-inner vue-slider-dot-tooltip-inner-left"},[e("span",{staticClass:"vue-slider-dot-tooltip-text"},[t._v(t._s(t._f("round")(i)))])])])]}}]),model:{value:t.scale,callback:function(e){t.scale=e},expression:"scale"}},"vue-slider",t.options,!1))],1)}),[],!1,null,"41d7e756",null);e.default=s.exports}}]);