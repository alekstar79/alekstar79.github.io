(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{514:function(t,r,e){"use strict";e.r(r),function(t){e.d(r,"frameAddFunctionality",(function(){return m}));var n=e(2),o=e(69),c=(e(25),e(3),e(12),e(16),e(19),e(26),e(9),e(27),e(163)),i=e(158),a=e(4),s=["source","frame"];function u(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function l(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?u(Object(e),!0).forEach((function(r){Object(n.a)(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):u(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function f(){}function m(r){var e,n,u=void 0===t||!0;return r.Frame=r.util.createClass(r.Image,{type:"frame",source:null,frame:null}),r.Frame.prototype.initialize=(e=r.Frame.prototype.initialize,function(t,r){var n=this,c=r.source,i=r.frame,a=Object(o.a)(r,s);e.call(this,t,a),this.source=c,this.frame=i,this.on("added",(function(){n.cornersOn()}))}),r.Frame.prototype.toObject=(n=r.Frame.prototype.toObject,function(t){return n.call(this,["source","frame"].concat(t))}),r.Frame.prototype.imageExtract=function(){var t=this;return new Promise((function(e){var n=t.source;r.Image.fromObject(n,(function(r){t.setSrc(t.frame,(function(){t.src=t.frame,t.source=null,t.canvas.insertTo(r),t.cornersOn(),e()}))}))}))},r.Frame.prototype.imageInsert=function(t){var r=this;return new Promise((function(e){var n=r.toCanvasElement({withoutTransform:!0}),o=n.getContext("2d");o.globalCompositeOperation="source-in",o.drawImage(t._element,0,0,t._element.width,t._element.height,0,0,n.width,n.height),r.src=n.toDataURL(),r.setSrc(r.src,(function(){r.source=t.toObject(),r.canvas.remove(t),e()}))}))},r.Frame.prototype.insert=Object(i.debounce)((function(){this.canvas&&this.canvas.trigger("frame:composite",this)}),0),r.Frame.prototype.extract=function(){var t=this;this.imageExtract().catch((function(){t.canvas.trigger("canvas:snack",{content:"Extract image error",color:"warning"})}))},r.Frame.prototype.cornersOn=u?function(){Object(a.setControls)(this,{tr:{action:(this.source?this.extract:this.insert).bind(this),cursor:"pointer"}},{tr:{icon:this.source?c.close:c.plus}})}:f,r.Frame.prototype.cornersOff=u?function(){Object(a.setControls)(this,{bl:{action:null,cursor:"pointer"},br:{action:null,cursor:"pointer"},mb:{action:null,cursor:"pointer"},tr:{action:null,cursor:"pointer"}},{tr:{icon:c.finger}})}:f,r.Frame.fromURL=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r.util.loadImage(t,(function(o){if(!o)return e(null);e(new r.Frame(o,l(l({},n),{},{source:null,frame:t})))}),null,n.crossOrigin)},r.Frame.fromObject=function(t,e){var n=r.util.object.clone(t);r.util.loadImage(n.src,(function(t,o){if(o)return e(null,o);e(new r.Frame(t,n))}),null,n.crossOrigin)},r}}.call(this,e(38))}}]);