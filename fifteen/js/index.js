!function(t){const e=document.querySelector(".page"),r=document.querySelector(".fifteen"),n=Array.from(r.querySelectorAll(".item"));var a=document.querySelector(".shuffle");let s=Array.from(Array(16),(e,t)=>t+1),i=t.getMatrix(n.map(e=>Number(e.dataset.matrixId))),o=150,l=null,d=null,u;function y(e){for(let t=0;t<i.length;t++)for(let e=0;e<i[t].length;e++)n[i[t][e]-1].style.transform=`translate(${100*e}%, ${100*t}%)`;e||l||!function(){var t=i.flat();for(let e=0;e<s.length;e++)if(t[e]!==s[e])return;return 1}()||setTimeout(()=>{r.classList.add("fifteenWin"),setTimeout(()=>{r.classList.remove("fifteenWin")},1500)},200)}n[15].style.display="none",r.addEventListener("click",({target:e})=>{!l&&(u=e.closest("button"))&&(i=t.changePositionByClick(Number(u.dataset.matrixId),i,16),y())}),a.addEventListener("click",()=>{l||(e.classList.add("shuffling"),l=setInterval(()=>{o<=0&&(e.classList.remove("shuffling"),clearInterval(l),o=150,l=null),{matrix:i,block:d}=t.randomSwap(i,16,d),y(),o--},70))}),window.addEventListener("keydown",({key:e})=>{!l&&e.toLowerCase().includes("arrow")&&(e=e.split("Arrow")[1].toLowerCase(),i=t.changePositionByKeydown(e,i,16),y())}),y(!0)}(new class{getMatrix(e){var t=[[],[],[],[]];let r,n,a;for(r=n=a=0;a<e.length;a++)4<=r&&(r=0,n++),t[n][r]=e[a],r++;return t}changePositionByClick(e,t,r){e=this.findCoordsByNumber(e,t),r=this.findCoordsByNumber(r,t);return this.isValidForSwap(e,r)?this.swapTiles(e,r,t):t}changePositionByKeydown(e,t,r){var r=this.findCoordsByNumber(r,t),n={x:r.x,y:r.y},a=t.length;switch(e){case"up":n.y+=1;break;case"down":--n.y;break;case"left":n.x+=1;break;case"right":--n.x}return n.y<a&&n.x<a&&0<=n.y&&0<=n.x?this.swapTiles(n,r,t):t}findCoordsByNumber(r,n){for(let t=0;t<n.length;t++)for(let e=0;e<n[t].length;e++)if(n[t][e]===r)return{x:e,y:t};return null}findValidCoords(r,n,a){var s=[];for(let t=0;t<a.length;t++)for(let e=0;e<a[t].length;e++)n&&n.x===e&&n.y===t||this.isValidForSwap({x:e,y:t},r)&&s.push({x:e,y:t});return s[Math.random()*s.length|0]}isValidForSwap(e,t){var r;return(e?.x===t?.x||e?.y===t?.y)&&(r=Math.abs(e.x-t.x),e=Math.abs(e.y-t.y),1===r||1===e)}swapTiles(e,t,r){var n=r[e.y][e.x];return r[e.y][e.x]=r[t.y][t.x],r[t.y][t.x]=n,r}randomSwap(e,t,r){t=this.findCoordsByNumber(t,e),r=this.findValidCoords(t,r,e);return{matrix:this.swapTiles(r,t,e),block:t}}});