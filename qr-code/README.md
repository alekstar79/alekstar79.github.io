<!--suppress HtmlDeprecatedAttribute -->
<p align="center">QRCreator.js</p>
<p align="center">Make now QR-code.</p>
<p align="center">
 <img src="assets/review.gif" alt="">
</p>

[ДЕМО](https://alekstar79.github.io/qr-code)

<h2>ПОДКЛЮЧЕНИЕ</h2>

1. Сохраните файл _[qr-code.js](https://raw.githubusercontent.com/alekstar79/qr-code/main/dist/js/qr-code.js)_  
   По ссылке страница перенаправляется на содержимое файла.<br>Нажмите правую кнопку мыши ( или сочетание клавиш `Ctrl`+`S` / `CMD`+`S` ) и выберите `Сохранить как`<br>
2. В html файле, в теге `<head>` вставьте тег `<script>` с указанием ссылки на файл QRCreator.js
````
<script src="qr-code.js" defer><script/>
````

### Пример подключения

```html
<html lang="en">
<head>
 <script src="qr-code.js"></script>
 <title></title>
</head>
<body>
  <div id="qrcode"></div>
</body>

<script>
 document.getElementById('qrcode').append(makeQRCode('Привет, Мир!').result)
</script>
</html>
```

### Пример подключения с вызовом из js-файла

```html
<html lang="en">
<head>
 <script src="qr-code.js" defer></script>
 <script src="main.js" defer></script>
 <title></title>
</head>
<body>
 <div id="qrcode1"></div>
 <div id="qrcode2"></div>
</body>
</html>
```

__main.js__
```js
const qrcode1 = makeQRCode('Привет, Мир!', { mode: 4, eccl: 0, version: 3, mask: -1, image: 'html', modsize: -1, margin: 0 })
const qrcode2 = makeQRCode('Привет, Мир!', { mode: 1})

const content = qrcode => qrcode.error ? `недопустимые исходные данные ${qrcode.error}` : qrcode.result

document.getElementById('qrcode1').append('QR-код № 1: ', content(qrcode1))
document.getElementById('qrcode2').append('QR-код № 2: ', content(qrcode2))
```

<h2>СИНТАКСИС</h2>

window.makeQRCode(text [, options ])

или

makeQRCode(text [, options ])

### Параметры

__text__<br>Кодируемая текстовая строка UTF-8.

__options__<br>Объект, содержащий свойства со значениями параметров генерации QR-кода, по умолчанию:<br>`{mode: -1,  eccl: 0, version: -1, mask: -1, image: 'PNG', modsize: -1, margin: -1}`

### Возвращаемое значение

Объект __`qrcode`__, описывающий результат генерации QR-кода.

<h2>ОПИСАНИЕ</h2>

### 1. Свойство `options`

#### 1.1. Основные свойства `options`, содержащие значения параметров формирования матрицы QR-кода

|  свойство   |                    значение                    | содержание                                                                                                                                   |
|:-----------:|:----------------------------------------------:|:---------------------------------------------------------------------------------------------------------------------------------------------|
|  __mode__   |         целое число<br>__-1, 1, 2, 4__         | __метод кодирования__<br> 1 - числовой,<br> 2 - буквенно-цифровой,<br> 4 - октетный,<br> если не указан или -1,<br> то выбирается допустимый |
|  __eccl__   |         целое число<br>__от -1 до 3__          | __уровень коррекции ошибок__<br> 1(__L__), 0(__M__), 3(__Q__), 2(__H__)<br> если не указан или -1,<br> то подбор допустимого, начиная с 3(Q) |
| __version__ | целое число<br>__-1__<br>или<br>__от 1 до 40__ | __версия__<br> если не указана или -1, то выбирается наименьшая возможная                                                                    |
|  __mask__   | целое число<br>__-1__<br>или<br>__от 0 до 7__  | __шаблон маски__<br>если не указан или -1,  то выбирается лучшая маска                                                                       |

#### 1.2. Дополнительные свойства `options`, содержащие значения параметров формирования изображения

|  свойство   |                                      значение                                       | содержание                                                                                                                                   |
|:-----------:|:-----------------------------------------------------------------------------------:|:---------------------------------------------------------------------------------------------------------------------------------------------|
|  __image__  | регистронезависимая строка<br>__'PNG'__, __'SVG'__, __'HTML'__<br>или<br>__'NONE'__ | __формат изображения__,<br>если не указан, то результат выводится в формате 'PNG',<br>при задании значения 'NONE' - результат не формируется |
| __modsize__ |                      целое число<br>__-1__<br>или<br>__от 1__                       | __размер модуля<br> `modsize x modsize`__<br>если не указан или -1, то 4                                                                     |
| __margin__  |                               целое число<br>__от 0__                               | __размер свободной зоны в модулях__,<br>если не указан, то 4 модуля                                                                          |

### 2. Возвращаемый объект `qrcode`

#### 2.1. Свойства `qrcode`

|                    свойство                    |                                   значение                                    | содержание                                                                                                                             |
|:----------------------------------------------:|:-----------------------------------------------------------------------------:|:---------------------------------------------------------------------------------------------------------------------------------------|
|                    __text__                    |                                   заданное                                    | __исходный текст__                                                                                                                     |
| __mode__<br>__eccl__<b>__version__<br>__mask__ |                        заданное<br>или<br>подобранное                         | __параметры сформированной матрицы QR-кода__                                                                                           |
|           __modsize__<br>__margin__            |                        заданно<br>или<br>по умолчанию                         | __параметры сформированной матрицы QR-кода__<br>и __параметры изображения QR-кода__                                                    |
|                   __image__                    |                                   заданное                                    | __формат изображения QR-кода__<br>или<br>__'NONE'__                                                                                    |
|                   __matrix__                   | __массив [`у`][`х`]__<br>__`у`__`-индекс колонки,`<br>__`х`__`-индекс строки` | __матрица QR-кода__<br>где значение элемента матрицы соответствует цвету изображения модуля:<br> 0 - белый,<br> 1 - черный             |
|                   __result__                   |                       __HTML элемент__<br>или<br>__''__                       | __изображение QR-кода в заданом формате__<br>или<br>__пустая строка__ в случае ошибки, или когда был задан параметр `image === 'NONE'` |
|                   __error__                    |                       __имя свойства__<br>или<br>__''__                       | __имя свойства, значение которого вызвало ошибку__<br>или<br> __пустая строка__ при отстутствии ошибок                                 |
|                __errorSubcode__                |       строка<br>с целочисленным<br>цифроовым __кодом__<br>или<br>__''__       | __код, поясняющий ошибку__<br>или<br>__пустая строка__ при отстутствии ошибок                                                          |

<br>

#### 2.2. Методы `qrcode`

__<p>`qrcode.`image = newImage</p>__

__`newImage`__<br>новое значение формата изображения<br>
При изменении текущего формата `qrcode.image` на новое значение `newImage` происходит переформирование изображения.
>Процесс может вызвать ошибку:<br> `qrcode.error === "image"`.

<br>__<p>`qrcode.`download (`filename`, `image`)</p>__ Вызывает скачивание изображения QR-кода в виде файла с именем `filename` в формате `image`.

__`filename`__<br>Имя файла для скачивания изображения, включая расширение.
>Если параметр `filename` не задан или `filename === ''`, то `filename` примает значение по умолчанию:<br>
 -`'qrcode.png'` при `qrcode.image === 'PNG'`<br>
 -`'qrcode.svg'` при `qrcode.image === 'SVG'`<br>
 -`'qrcode.html'` при `qrcode.image === 'HTML'`

__`image`__<br>Формат файла изображения QR-кода.
>Если параметр `image` не задан, то приниматся текущее значение `qrcode.image`.

>Если параметр `image` указан, то до вывода изображение переформируется  ( соответствует методу `qrcode.image = newImage`).

>Если при переформировании изображения произошла ошибка `qrcode.error !== ""` или задан формат `qrcode.image === 'NONE'` и, соответственно, отсутствует результат `qrcode.result === ''`, то запрос на скачиваение файла не выполняется.

<br>__<p>`qrcode`.clearError()</p>__ Очистка сообщения об ошибке `qrcode.error` и `qrcode.errorSubcode`.

>При наличии ошибок формирования изображения, методы: `qrcode.image = newImage` и `qrcode.download(filename, image)` не работают, пока сообщение не будет обработано и (или) очищено `qrcode.clearError()`

<br>

#### 2.3. Типы и подкоды ошибок

|    error    | errorSubcode | содержание                                            |
|:-----------:|:------------:|:------------------------------------------------------|
|  __text__   |    __1__     | недопустимый формат строки для кодирования            |
|  __text__   |    __2__     | не указан текст для кодирования                       |
|  __text__   |    __3__     | текст содержит недопустимые символы                   |
|  __mode__   |    __1__     | недопустимый или неподдерживаемый метод кодирования   |
| __version__ |    __1__     | слишком длинный текст для кодирования                 |
| __version__ |    __2__     | недопустимая версия                                   |
| __version__ |    __3__     | текст слишком длинный для выбранной версии            |
|  __eccl__   |    __1__     | недопустимый уровень коррекции ошибок                 |
|  __mask__   |    __1__     | недопустимый шаблон маски                             |
|  __image__  |    __1__     | недопустимый формат изображения для генерации QR-кода |
|  __image__  |    __2__     | для вывода в формате PNG необходима поддержка canvas  |
|  __image__  |    __3__     | недопустимый формат изображения для генерации QR-кода |
| __modsize__ |    __1__     | недопустимый размер модуля                            |
| __margin__  |    __1__     | недопустимый размер свободной зоны (в модулях)        |


<h2>СОВМЕСТИМОСТЬ С БРАУЗЕРАМИ</h2>
Chrome v.106, Firefox v.105, Яндекс.Браузер v.22, Brave v.1.44, Microsoft Edge v.106

<h2>ПОЛЕЗНЫЕ ССЫЛКИ</h2>

__Прототип [qrcode.js](https://github.com/shesek/qruri/blob/master/index.js)__


__Учебник__ [QR Code Tutorial](https://www.thonky.com/qr-code-tutorial/introduction)

__Habr.com__ [Алгоритм генерации QR-кода](https://habr.com/ru/post/172525/)

__Стандарт__ [Спецификация символики штрихового кода QR Code ISO/IEC 18004:2015](https://meganorm.ru/Data2/1/4293763/4293763455.pdf)
